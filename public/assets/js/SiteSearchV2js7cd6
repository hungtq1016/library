function manipulateUrl(n,t){return n+"?query="+t}function htmlEncode(n){return $("<div/>").text(n).html()}function submitSearch(n){var e=$(n),t=e.closest("form"),u=t.find("#searchInput"),o=t.find(".u_search__filter"),r=o.val(),i="",f;if(r!="1"&&r!="6"){switch(r){case"2":i="eBook";break;case"3":i="Audiobook";break;case"4":i="Periodicals";break;case"5":i="Video"}f=$("<input>",{type:"hidden",name:"f-formatClassification",value:i});t.attr("action","/search");t.append($(f))}else r==6&&(t.attr("action","/libraries"),t.find("#libSearchMode").length===0&&t.append('<input type="hidden" value="name" name="mode" id="libSearchMode" />'));return u.val(htmlEncode(u.val())),t.submit(),!1}var siteRoot,setupTypeahead=function(n){function u(){var n=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(n+Math.random()*16)%16|0;return n=Math.floor(n/16),(t=="x"?i:i&3|8).toString(16)})}var t=new Bloodhound({limit:100,datumTokenizer:Bloodhound.tokenizers.obj.whitespace("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:siteRoot+"autocomplete/searches/?query=%QUERY&token="+u(),cache:!1},rateLimitWait:100}),r=new Bloodhound({limit:10,datumTokenizer:Bloodhound.tokenizers.obj.whitespace("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:siteRoot+"autocomplete/searchsite/?query=%QUERY"},dupDetector:function(n,t){return n.value===t.value},rateLimitWait:100}),i=[];t.initialize();r.initialize();n!=6&&(i=i.concat([{displayKey:"value",source:t.ttAdapter(),templates:{header:"<h5>Saved Searches<\/h5>",footer:'<a href="/account/searches">All saved searches<\/a>'}},{name:"newSearch",source:r.ttAdapter(),templates:{suggestion:function(n){return'<div class="search-suggestion needsclick"><div class="type needsclick">'+window.OverDrive.SiteCopy.get(n.type)+'<\/div><div class="value needsclick">'+n.value+"<\/div><\/div>"}}}]));$(".u_search__query").on("focus",function(){this.origPlaceholder=$(this).attr("placeholder");$(this).attr("placeholder","")}).on("blur",function(){$(this).attr("placeholder",this.origPlaceholder)}).typeahead({highlight:!1,minLength:0},i).on("typeahead:selected",function(n,t){t.jumpUrl?window.location.href=t.jumpUrl:($(".u_search__filter").val(1),$("#searchInput").val(t.value),submitSearch())}).on("typeahead:opened",function(){t.clear();t.clearPrefetchCache();t.clearRemoteCache();t.initialize(!0);var n=$.Event("keydown");return n.keyCode=n.which=40,$(this).trigger(n),!0});$("#search .u_search__filter").change(function(){$(".u_search__query").typeahead("destroy");setupTypeahead($(this).val())});window.OverDrive.BlockFastClickJs||$(".tt-dropdown-menu").bind("DOMNodeInserted",function(n){$(n.target).find(".tt-suggestion").children("p").addClass("needsclick")})};jQuery.fn.dataTableExt.oApi.fnProcessingIndicator=function(n,t){typeof t=="undefined"&&(t=!0);this.oApi._fnProcessingDisplay(n,t)};jQuery.extend(jQuery.fn.dataTableExt.oSort,{"distance-pre":function(n){if(n){var t=n.split(" ")[0];return parseFloat(t)}return 0},"distance-asc":function(n,t){return n<t?-1:n>t?1:0},"distance-desc":function(n,t){return n<t?1:n>t?-1:0}}),function(n,t,i){n.OverDrive.BlockFastClickJs||FastClick.attach(t.body);setupTypeahead(1);var f="",e=function(){i(".results").length&&i(".result img").unveil(650,function(){i(this).load(function(){i(this).css({width:"100%",marginTop:"0"})})});i(n).on("breakpointChange",function(n,t){f=t});i("#resendVerifyEmailLink").length&&o();i("div.share").length&&s();h();c();i("body").on("click","input[type=button].add-library",r);i("body").on("click","input[type=button].remove-library",u);i(function(){function r(){if(/iP(hone|od|ad)/.test(navigator.platform)){var n=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3]||0,10)]}return!1}var f=r()?r()[0]<8:!1,t=i("body"),u;f&&(i(".u_masthead, .u_search, .u_search__form").css("position","absolute"),i(".u_search__form").css("top",i(n).width()<768?"0px":"-65px"));t.hasClass("transparent-top")?(i(".container").css("margin-top","0px"),i(".libby-head").css("display","none"),i(".u_masthead").css("top","0"),u=i(n),i(n).scroll(function(){var r=i("#scroll-to").offset().top,e=i("#scroll-to").outerHeight(),o=i(n).height(),f=i(this).scrollTop(),s;f>r+e-o&&r>f&&f+o>r+e?(t.addClass("transparent-top"),i(".libby-head").css("display","none"),i(".u_masthead").css("top","0px")):(t.removeClass("transparent-top"),i(".libby-head").css("display","block"));s=OverDrive.transparentMastHeadScrollH||25;u.scrollTop()>=s?t.removeClass("transparent-top"):t.addClass("transparent-top")})):i(".libby-head").css("display","block")})},r=function(){var n=i(this),t=n.attr("data-id"),r="/user-libraries/add-library/"+t;return n.attr("disabled","disabled"),i.ajax({type:"POST",url:r,data:{},success:function(){n.unbind("click").click(u).removeAttr("disabled").addClass("btnHollowActive").val("Saved")},error:function(){n.removeAttr("disabled")}}),!1},u=function(){var n=i(this),t=n.attr("data-id"),u="/user-libraries/remove-library/"+t;return n.attr("disabled","disabled"),i.ajax({type:"POST",url:u,data:{},success:function(){n.unbind("click").click(r).removeAttr("disabled").removeClass("btnHollowActive").val("Save")},error:function(){n.removeAttr("disabled")}}),!1},o=function(){var t=i("#resendVerifyEmailLink"),n=t.closest("div"),e=n.find("#unverifiedMessage"),r=n.find("#workingMessage"),u=n.find("#emailSentMessage"),f=n.find("#errorMessage");t.click(function(){return n.children().hide(),r.show(),i.ajax({url:siteRoot+"account/request-verification",type:"POST",contentType:"application/json",processData:!1,datatype:"json"}).success(function(){n.children().hide();u.show()}).error(function(){n.children().hide();f.show()}),!1})},s=function(){i("div.optGroup a").on("click",function(){var n=i(this),t=n.closest("div.share"),r=n.data("ga-action"),u,f;r&&(u=t.data("title"),f=t.data("id"),OverDrive.GA.record.title[r](u,f))})},h=function(){i('a[data-ga-action="exit"]').on("click",function(){var n=i(this),t=n.attr("href"),r=n.data("ga-label")||n.text();OverDrive.GA.record.exit(n.data("ga-location"),r,t)})},c=function(){i('a[data-ga-action="cover"]').on("click",function(){var n=i(this);OverDrive.GA.record.cover.clicked(n.data("title"),n.data("id"))});i('img[data-ga-action="cover"]').on("click",function(){var n=i(this);OverDrive.GA.record.cover.clicked(n.data("title"),n.data("id"))})};e()}(window,document,window.jQuery)